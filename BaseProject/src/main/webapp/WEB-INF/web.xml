<web-app
	version="3.0"
	xmlns="http://java.sun.com/xml/ns/javaee"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://java.sun.com/xml/ns/javaee
						http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd">

	<display-name>Base Project Web Application</display-name>
	
	
	
	<!-- ********** APPLICATION CONTEXT ********** -->
	
	<!-- Enable escaping of form submission contents -->
    <context-param>
        <param-name>defaultHtmlEscape</param-name>
        <param-value>true</param-value>
    </context-param>
    

	<!-- Application context configuration -->
	<context-param>
		<param-name>contextConfigLocation</param-name>
		<param-value>
			/WEB-INF/spring/security/spring-security-context.xml
			/WEB-INF/spring/jdbc/spring-persistence-context.xml
		</param-value>
	</context-param>

	<listener>
		<listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
	</listener>
	
	
	
	<!-- ********** SERVLETS ********** -->

	<!-- Servlet configuration -->
	<servlet>
		<servlet-name>springmvc-dispatcher</servlet-name>
		<!-- <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class> -->
		<servlet-class>com.jld.base.core.mvc.BaseProjectDispatcherServlet</servlet-class>
		<init-param>
			<param-name>contextConfigLocation</param-name>
			<param-value>/WEB-INF/spring/mvc/spring-mvc-servlet.xml</param-value>
		</init-param>
		<load-on-startup>1</load-on-startup>
		<multipart-config>
	        <location>C:\\test</location>
	        <max-file-size>5242880</max-file-size><!--5MB-->
	        <max-request-size>20971520</max-request-size><!--20MB-->
	        <file-size-threshold>0</file-size-threshold>
    	</multipart-config>
	</servlet>

	<servlet-mapping>
		<servlet-name>springmvc-dispatcher</servlet-name>
		<url-pattern>/</url-pattern>
	</servlet-mapping>
	
	
	
	<!-- ********** SESSION ********** -->
		
	<!-- Session timeout -->
	<session-config>
        <session-timeout>10</session-timeout>
    </session-config>
    
    
    
    <!-- ********** ERROR PAGES ********** -->
    
    <!-- Error pages customize -->
    <error-page>
    	<exception-type>java.lang.Exception</exception-type>
        <location>/errors/uncaughtException</location>
    </error-page>
    <error-page>
    	<!-- <error-code>404</error-code> -->
    	<location>/errors/errors</location>
    </error-page>



	<!-- ********** FILTERS ********** -->
	
	<!-- Servlet filters are used to preprocess Web application requests and postprocess servlet 
	responses. Some examples are filters for encryption, authentication, logging, auditing, data 
	compression or caching. -->

	<!-- Spring Security -->
	<filter>
		<filter-name>springSecurityFilterChain</filter-name>
		<filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
	</filter>

	<filter-mapping>
		<filter-name>springSecurityFilterChain</filter-name>
		<url-pattern>/*</url-pattern>		
		
		<!-- By default only ordinary requests go through the defined filter-mapping. Following two 
		lines make error HTTP requests go though the defined filter-mapping.
		They are used in this project to get information about session in the final JSP error page.
		See http://sqltech.cl/doc/oas10gR31/web.1013/b28959/filters.htm#BCFGCJID -->
		<dispatcher>REQUEST</dispatcher>
    	<dispatcher>ERROR</dispatcher>
	</filter-mapping>
	
	
	<!-- Encoding -->
	<filter>
        <filter-name>CharacterEncodingFilter</filter-name>
        <filter-class>org.springframework.web.filter.CharacterEncodingFilter</filter-class>
        <init-param>
            <param-name>encoding</param-name>
            <param-value>UTF-8</param-value>
        </init-param>
        <init-param>
            <param-name>forceEncoding</param-name>
            <param-value>true</param-value>
        </init-param>
    </filter>
    
    <filter-mapping>
		<filter-name>CharacterEncodingFilter</filter-name>
		<url-pattern>/*</url-pattern>
	</filter-mapping>

</web-app>
